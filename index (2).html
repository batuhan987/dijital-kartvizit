<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dijital Asistan v8</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root { --primary: #2563eb; --dark: #0f172a; --bg: #e2e8f0; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); margin: 0; display: flex; height: 100vh; overflow: hidden; }

        /* MODAL */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.98); z-index: 9999; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .modal-box { background: white; width: 90%; max-width: 600px; padding: 2rem; border-radius: 16px; text-align: center; border: 1px solid #cbd5e1; }
        .modal-title { font-size: 1.4rem; font-weight: 800; margin-bottom: 1rem; color: #dc2626; }
        .modal-text { font-size: 0.9rem; text-align: left; background: #fff1f2; padding: 20px; border-radius: 8px; margin-bottom: 2rem; max-height: 40vh; overflow-y: auto; border: 1px solid #fecaca; line-height: 1.5; }
        .modal-btn { background: var(--dark); color: white; border: none; padding: 15px 30px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; font-size: 1rem; transition: 0.2s; }

        /* EDƒ∞T√ñR */
        .editor-panel { width: 420px; background: white; padding: 2rem; overflow-y: auto; border-right: 1px solid #ddd; z-index: 10; display: flex; flex-direction: column; gap: 1rem; }
        .section-title { font-size: 0.8rem; font-weight: 800; color: #64748b; text-transform: uppercase; margin-top: 1rem; border-bottom: 2px solid #f1f5f9; padding-bottom: 5px; }
        .form-group label { display: block; font-size: 0.85rem; font-weight: 600; color: #334155; margin-bottom: 5px; }
        .form-control { width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 8px; font-size: 0.9rem; box-sizing: border-box; }
        
        .style-tools { display: flex; gap: 10px; align-items: center; margin-top: 5px; }
        .style-btn { width: 35px; height: 35px; border: 1px solid #cbd5e1; border-radius: 6px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .style-btn.active { background: var(--dark); color: white; }
        .color-input { width: 40px; height: 35px; padding: 2px; border: 1px solid #ccc; border-radius: 6px; cursor: pointer;}

        .btn-generate { background: var(--dark); color: white; border: none; padding: 15px; border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 20px; width: 100%; }
        
        .link-result { background: #eff6ff; border: 1px solid #bfdbfe; padding: 20px; border-radius: 12px; display: none; margin-top: 15px; text-align: center; }
        .link-actions { display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap;}
        .action-sm-btn { flex: 1; padding: 10px; border: none; border-radius: 6px; cursor: pointer; font-size: 0.85rem; font-weight: 600; min-width: 120px; }
        .btn-copy { background: #3b82f6; color: white; }
        .btn-shorten { background: #f59e0b; color: white; text-decoration: none; display: flex; align-items: center; justify-content: center;}
        .btn-print { background: #10b981; color: white; width: 100%; margin-top: 10px; display: flex; align-items: center; justify-content: center; gap: 8px; }

        /* QR Kod Kutusu (Edit√∂rde g√∂r√ºnen k√º√ß√ºk versiyon) */
        #qrcode { margin: 15px auto; display: flex; justify-content: center; background: white; padding: 10px; border-radius: 8px; width: fit-content; border: 1px solid #ddd; }
        
        /* Gƒ∞ZLƒ∞ QR KOD (POSTER ƒ∞√áƒ∞N DEV BOYUT) */
        #qrcode-high-res { position: absolute; left: -9999px; }

        /* √ñNƒ∞ZLEME */
        .preview-area { flex: 1; display: flex; justify-content: center; align-items: center; background-image: radial-gradient(#cbd5e1 1px, transparent 1px); background-size: 20px 20px; }
        .phone-mockup { width: 340px; height: 680px; background: #1e293b; border-radius: 45px; padding: 12px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); border: 8px solid #334155; position: relative; transition: 0.3s; }
        .screen { background-color: #0f172a; background-size: cover; background-position: center; width: 100%; height: 100%; border-radius: 35px; overflow-y: auto; overflow-x: hidden; position: relative; color: white; display: flex; flex-direction: column; }
        .screen-overlay { position: absolute; top:0; left:0; width:100%; height:100%; background: linear-gradient(to bottom, rgba(0,0,0,0.2), rgba(0,0,0,0.9)); z-index: 1; pointer-events: none; }
        .content-wrapper { position: relative; z-index: 2; height: 100%; display: flex; flex-direction: column; }

        .card-header { text-align: center; padding: 3rem 1.5rem 1.5rem; }
        .logo-box { width: 110px; height: 110px; margin: 0 auto 1rem; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; overflow: hidden; border: 4px solid rgba(255,255,255,0.3); }
        .logo-img { width: 100%; height: 100%; object-fit: cover; }
        .firm-name { font-size: 1.6rem; font-weight: 800; margin: 0; line-height: 1.2; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .firm-title { font-size: 0.95rem; opacity: 0.95; margin-top: 8px; text-shadow: 0 1px 2px rgba(0,0,0,0.5); }

        .action-list { padding: 0 1.5rem; display: flex; flex-direction: column; gap: 14px; margin-top: 10px; }
        .action-btn { display: flex; align-items: center; padding: 14px; border-radius: 14px; text-decoration: none; color: white; font-weight: 600; font-size: 0.95rem; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); transition: transform 0.2s; }
        .action-btn i { width: 30px; font-size: 1.3rem; text-align: center; margin-right: 12px; }

        .btn-iban-content { display: flex; flex-direction: column; width: 100%; overflow: hidden; }
        .iban-label { font-size: 0.8rem; opacity: 0.8; margin-bottom: 2px; }
        .iban-number { font-family: 'Courier New', monospace; font-size: 0.8rem; letter-spacing: 0px; font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        .bg-ws { background: linear-gradient(90deg, #25D366 0%, #128C7E 100%); border: none; }
        .bg-map { background: linear-gradient(90deg, #f59e0b 0%, #d97706 100%); border: none; }
        
        .footer { margin-top: auto; padding: 25px; text-align: center; color: rgba(255,255,255,0.6); font-size: 0.8rem; }
        .dev-signature a { color: rgba(255,255,255,0.8); text-decoration: none; border-bottom: 1px dotted rgba(255,255,255,0.5); }

        /* MASA√úST√ú VIEW MODE D√úZELTMESƒ∞ */
        body.view-mode { background-color: #111827; display: flex; align-items: center; justify-content: center; }
        body.view-mode .editor-panel { display: none; }
        body.view-mode .preview-area { background: transparent; width: auto; padding: 20px; }
        body.view-mode .phone-mockup { width: 380px; height: 85vh; max-height: 800px; box-shadow: 0 0 50px rgba(0,0,0,0.5); margin: 0 auto; }

        /* MOBƒ∞L RESPONSIVE */
        @media (max-width: 768px) {
            body.view-mode { background: #000; }
            body.view-mode .preview-area { width: 100%; height: 100%; padding: 0; }
            body.view-mode .phone-mockup { width: 100%; height: 100%; border: none; border-radius: 0; box-shadow: none; padding: 0; }
            body.view-mode .screen { border-radius: 0; }
            .editor-panel { width: 100%; z-index: 20; position: absolute; height: 100%; }
            .preview-area { display: none; }
        }

        .hidden { display: none !important; }
        .toast { position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 12px 30px; border-radius: 30px; opacity: 0; transition: 0.3s; pointer-events: none; z-index: 10; box-shadow: 0 4px 15px rgba(0,0,0,0.3); font-weight: bold; }
    </style>
</head>
<body>

    <div class="modal-overlay" id="legalModal">
        <div class="modal-box">
            <div class="modal-title"><i class="fas fa-exclamation-triangle"></i> Yasal Bilgilendirme</div>
            <div class="modal-text">
                <strong>1. √úcretsiz Yazƒ±lƒ±m:</strong> Bu sistem, acentelerin dijitalle≈ümesi i√ßin Batuhan Bayatlƒ± tarafƒ±ndan √ºcretsiz geli≈ütirilmi≈ütir.<br><br>
                <strong>2. Veri G√ºvenliƒüi:</strong> Veritabanƒ± kullanƒ±lmamaktadƒ±r. T√ºm bilgiler (IBAN vb.) olu≈üturulan linkin i√ßinde ≈üifrelenmeden ta≈üƒ±nƒ±r. Linki payla≈ütƒ±ƒüƒ±nƒ±z ki≈üiler bu bilgileri g√∂rebilir.<br><br>
                <strong>3. Sorumluluk Reddi:</strong> Sistem "olduƒüu gibi" sunulmu≈ütur. Kullanƒ±mdan doƒüabilecek ticari veya veri kayƒ±plarƒ±ndan, link kƒ±saltma servislerinin (TinyURL vb.) g√ºvenliƒüinden <strong>geli≈ütirici sorumlu deƒüildir.</strong>
            </div>
            <button class="modal-btn" onclick="acceptLegal()">Okudum ve Kabul Ediyorum</button>
        </div>
    </div>

    <div class="editor-panel">
        <h2 style="margin:0; color:var(--dark);"><i class="fas fa-magic"></i> Asistan Olu≈üturucu</h2>
        
        <div class="section-title">Firma Bilgileri</div>
        <div class="form-group">
            <label>Firma Adƒ±</label>
            <input type="text" class="form-control" id="inpName" placeholder="√ñrn: G√ºne≈ü Sigorta" oninput="updatePreview()">
            <div class="style-tools">
                <div class="style-btn" onclick="toggleStyle('nameBold', this)"><i class="fas fa-bold"></i></div>
                <div class="style-btn" onclick="toggleStyle('nameItalic', this)"><i class="fas fa-italic"></i></div>
                <input type="color" class="color-input" id="colText" value="#ffffff" oninput="updatePreview()">
            </div>
            <input type="hidden" id="nameBold" value="false">
            <input type="hidden" id="nameItalic" value="false">
        </div>

        <div class="form-group">
            <label>√únvan</label>
            <input type="text" class="form-control" id="inpTitle" placeholder="Yetkili Acente" oninput="updatePreview()">
        </div>

        <div class="section-title">G√∂rsel</div>
        <div class="form-group">
            <label>Logo URL (Varsa)</label>
            <input type="text" class="form-control" id="inpLogo" placeholder="https://..." oninput="updatePreview()" style="margin-bottom:5px;">
        </div>
        <div class="form-group">
            <label>Arka Plan URL (Varsa)</label>
            <input type="text" class="form-control" id="inpBgImg" placeholder="https://..." oninput="updatePreview()">
        </div>
        <div class="form-group">
            <label>Arka Plan Rengi</label>
            <div style="display:flex; gap:10px;">
                <input type="color" class="color-input" id="colBg1" value="#1e293b" oninput="updatePreview()">
                <input type="color" class="color-input" id="colBg2" value="#0f172a" oninput="updatePreview()">
            </div>
        </div>

        <div class="section-title">ƒ∞leti≈üim</div>
        <div class="form-group"><label>Telefon</label><input type="tel" class="form-control" id="inpPhone" oninput="formatPhone(this); updatePreview()"></div>
        <div class="form-group"><label>WhatsApp</label><input type="tel" class="form-control" id="inpWs" oninput="formatPhone(this); updatePreview()"></div>
        <div class="form-group"><label>Adres</label><textarea class="form-control" id="inpAddress" rows="2" oninput="updatePreview()"></textarea></div>
        
        <div class="form-group" style="background:#f8fafc; padding:10px; border:1px solid #e2e8f0; border-radius:8px;">
            <label><i class="fas fa-globe"></i> Web Sitesi</label>
            <input type="text" class="form-control" id="inpWeb" placeholder="www.site.com" oninput="updatePreview()">
            <div style="margin-top:5px; display:flex; gap:5px;"><input type="color" class="color-input" id="colWeb" value="#6366f1" oninput="updatePreview()"></div>
        </div>

        <div class="section-title">Finans</div>
        <div class="form-group">
            <label>IBAN (Max 32 Karakter)</label>
            <input type="text" class="form-control" id="inpIban" placeholder="TR..." oninput="formatIBAN(this); updatePreview()">
        </div>
        <div class="form-group"><label>Arama Buton Rengi</label><input type="color" class="color-input" id="colBtn" value="#3b82f6" oninput="updatePreview()"></div>

        <button class="btn-generate" onclick="generateLink()">‚ú® QR Kod ve Link √úret</button>
        
        <div class="link-result" id="resBox">
            <div style="font-size:0.8rem; color:#64748b; margin-bottom:5px;">Mobil √ñnizleme QR Kodu:</div>
            <div id="qrcode"></div>
            <div id="qrcode-high-res"></div>
            
            <div class="link-actions">
                <button class="action-sm-btn btn-copy" onclick="copyLink()">üìã Linki Kopyala</button>
                <a href="https://tinyurl.com/app" target="_blank" class="action-sm-btn btn-shorten">‚úÇÔ∏è Kƒ±salt (TinyURL)</a>
            </div>
            <button class="action-sm-btn btn-print" onclick="printPoster()"><i class="fas fa-print"></i> A4 Poster Yazdƒ±r (Asmak ƒ∞√ßin)</button>
            <input type="text" id="finalLinkInput" style="opacity:0; height:1px; width:1px;">
        </div>
    </div>

    <div class="preview-area">
        <div class="phone-mockup">
            <div class="screen" id="screenEl">
                <div class="screen-overlay"></div>
                <div class="content-wrapper">
                    <div class="card-header">
                        <div class="logo-box">
                            <img src="" id="cardLogo" class="logo-img" style="display:none;" onerror="this.style.display='none'; this.nextElementSibling.style.display='block'">
                            <i class="fas fa-building" id="logoIcon" style="font-size:3rem; color:#ccc;"></i>
                        </div>
                        <h1 class="firm-name" id="cardName">Firma Adƒ±</h1>
                        <div class="firm-title" id="cardTitle">√únvan</div>
                    </div>

                    <div class="action-list">
                        <a href="#" class="action-btn bg-ws" id="btnWs"><i class="fab fa-whatsapp"></i> WhatsApp</a>
                        <a href="#" class="action-btn" id="btnCall"><i class="fas fa-phone-alt"></i> Hemen Ara</a>
                        <a href="#" class="action-btn hidden" id="btnWeb" target="_blank"><i class="fas fa-globe"></i> Web Sitesi</a>
                        <a href="#" class="action-btn bg-map" id="btnMap" target="_blank"><i class="fas fa-map-marker-alt"></i> Konuma Git</a>
                        
                        <div class="action-btn" onclick="copyToClipboard()" style="background: rgba(255,255,255,0.15); cursor: pointer; border: 1px solid rgba(255,255,255,0.2);">
                            <i class="far fa-credit-card"></i>
                            <div class="btn-iban-content">
                                <span class="iban-label">IBAN Kopyalamak ƒ∞√ßin Tƒ±kla</span>
                                <span class="iban-number" id="ibanDisplay">TR00 0000 0000 0000 0000 0000 00</span>
                            </div>
                            <input type="hidden" id="rawIban">
                        </div>
                    </div>

                    <div class="footer">
                        <div>Dijital Asistan Sistemi</div>
                        <div class="dev-signature">Developed by <a href="https://www.linkedin.com/in/batuhanbayatlƒ±/" target="_blank">Batuhan Bayatlƒ±</a></div>
                    </div>
                </div>
                <div class="toast" id="toast">IBAN Kopyalandƒ±! ‚úÖ</div>
            </div>
        </div>
    </div>

    <script>
        function checkLegal() {
            const params = new URLSearchParams(window.location.search);
            if (params.has('name')) document.getElementById('legalModal').style.display = 'none';
            else document.getElementById('legalModal').style.display = 'flex';
        }
        function acceptLegal() { document.getElementById('legalModal').style.display = 'none'; }

        function toggleStyle(inputId, btn) {
            const el = document.getElementById(inputId);
            el.value = el.value === 'true' ? 'false' : 'true';
            btn.classList.toggle('active');
            updatePreview();
        }

        function formatPhone(i) {
            let v = i.value.replace(/\D/g, '');
            if(v.startsWith('0')) v=v.substring(1);
            let f = '';
            if(v.length>0) f+='('+v.substring(0,3);
            if(v.length>=3) f+=') '+v.substring(3,6);
            if(v.length>=6) f+=' '+v.substring(6,8);
            if(v.length>=8) f+=' '+v.substring(8,10);
            i.value = f;
        }
        function formatIBAN(i) {
            let v = i.value.toUpperCase().replace(/[^A-Z0-9]/g, '').substring(0, 32); 
            i.value = v.match(/.{1,4}/g)?.join(' ') || v;
        }

        function updatePreview() {
            const name = document.getElementById('inpName').value || 'Firma Adƒ±';
            const title = document.getElementById('inpTitle').value || '√únvan';
            const phone = document.getElementById('inpPhone').value.replace(/\D/g,'');
            const ws = document.getElementById('inpWs').value.replace(/\D/g,'') || phone;
            const addr = document.getElementById('inpAddress').value;
            const web = document.getElementById('inpWeb').value;
            const iban = document.getElementById('inpIban').value;
            const logo = document.getElementById('inpLogo').value;
            const bgImg = document.getElementById('inpBgImg').value;

            // Renkler
            const cText = document.getElementById('colText').value;
            const cBg1 = document.getElementById('colBg1').value;
            const cBg2 = document.getElementById('colBg2').value;
            const cBtn = document.getElementById('colBtn').value;
            const cWeb = document.getElementById('colWeb').value;

            // DOM
            const elName = document.getElementById('cardName');
            const elTitle = document.getElementById('cardTitle');
            const elScreen = document.getElementById('screenEl');
            const btnWeb = document.getElementById('btnWeb');

            elName.innerText = name;
            elName.style.color = cText;
            elName.style.fontWeight = document.getElementById('nameBold').value === 'true' ? '800' : '400';
            elName.style.fontStyle = document.getElementById('nameItalic').value === 'true' ? 'italic' : 'normal';
            
            elTitle.innerText = title;
            elTitle.style.color = cText;

            if (bgImg && bgImg.length > 5) elScreen.style.backgroundImage = `url('${bgImg}')`;
            else elScreen.style.backgroundImage = `linear-gradient(135deg, ${cBg1} 0%, ${cBg2} 100%)`;

            document.getElementById('btnCall').style.background = cBtn;
            document.getElementById('btnCall').href = `tel:+90${phone}`;
            document.getElementById('btnWs').href = `https://wa.me/90${ws}?text=Merhaba`;
            document.getElementById('btnMap').href = addr ? `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(addr)}` : '#';

            if (web && web.length > 3) {
                btnWeb.classList.remove('hidden');
                btnWeb.href = web.startsWith('http') ? web : 'https://' + web;
                btnWeb.style.background = cWeb;
            } else { btnWeb.classList.add('hidden'); }

            document.getElementById('ibanDisplay').innerText = iban ? iban : 'TR00 0000...';
            document.getElementById('rawIban').value = iban;

            const img = document.getElementById('cardLogo');
            const icon = document.getElementById('logoIcon');
            if(logo && logo.length > 5) { img.src=logo; img.style.display='block'; icon.style.display='none'; }
            else { img.style.display='none'; icon.style.display='block'; }
        }

        function generateLink() {
            const baseUrl = window.location.href.split('?')[0];
            const p = new URLSearchParams();
            
            p.append('name', document.getElementById('inpName').value);
            p.append('title', document.getElementById('inpTitle').value);
            p.append('phone', document.getElementById('inpPhone').value);
            p.append('ws', document.getElementById('inpWs').value);
            p.append('addr', document.getElementById('inpAddress').value);
            p.append('web', document.getElementById('inpWeb').value);
            p.append('iban', document.getElementById('inpIban').value);
            p.append('logo', document.getElementById('inpLogo').value);
            p.append('bg', document.getElementById('inpBgImg').value);
            
            p.append('c1', document.getElementById('colBg1').value.replace('#',''));
            p.append('c2', document.getElementById('colBg2').value.replace('#',''));
            p.append('cb', document.getElementById('colBtn').value.replace('#',''));
            p.append('cw', document.getElementById('colWeb').value.replace('#',''));
            p.append('ct', document.getElementById('colText').value.replace('#',''));
            p.append('sb', document.getElementById('nameBold').value === 'true' ? '1' : '0');
            p.append('si', document.getElementById('nameItalic').value === 'true' ? '1' : '0');

            const fullLink = `${baseUrl}?${p.toString()}`;
            
            document.getElementById('resBox').style.display = 'block';
            document.getElementById('finalLinkInput').value = fullLink;

            // K√ú√á√úK QR (Ekranda g√∂r√ºnmesi i√ßin)
            const qrContainer = document.getElementById("qrcode");
            qrContainer.innerHTML = "";
            new QRCode(qrContainer, {
                text: fullLink,
                width: 150,
                height: 150,
                correctLevel : QRCode.CorrectLevel.L // Low Correction = Daha az nokta = Daha kolay okuma
            });

            // Gƒ∞ZLƒ∞ DEV QR (Poster i√ßin)
            const qrHighRes = document.getElementById("qrcode-high-res");
            qrHighRes.innerHTML = "";
            new QRCode(qrHighRes, {
                text: fullLink,
                width: 400, // √áOK DAHA B√úY√úK
                height: 400,
                correctLevel : QRCode.CorrectLevel.L
            });
        }
        
        function printPoster() {
            const name = document.getElementById('inpName').value || "Firma Adƒ±";
            const title = document.getElementById('inpTitle').value || "Yetkili Acente"; // D√úZELTƒ∞LDƒ∞: Artƒ±k √únvan yazacak
            const logo = document.getElementById('inpLogo').value;
            
            // Gizli Y√ºksek √á√∂z√ºn√ºrl√ºkl√º QR'ƒ± al
            const qrCanvas = document.querySelector('#qrcode-high-res canvas');
            if(!qrCanvas) { alert("√ñnce Link Olu≈ütur butonuna basƒ±n!"); return; }
            const qrImgData = qrCanvas.toDataURL("image/png");

            // Logo varsa HTML'ini hazƒ±rla
            let logoHtml = '';
            if (logo && logo.length > 5) {
                logoHtml = `<img src="${logo}" style="width:120px; height:120px; object-fit:contain; margin-bottom:15px;">`;
            } else {
                logoHtml = `<div style="font-size:4rem; color:#ccc; margin-bottom:15px;">üè¢</div>`;
            }

            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>${name} - Poster</title>
                    <style>
                        body { 
                            font-family: 'Segoe UI', sans-serif; text-align: center; 
                            padding: 0; margin: 0; height: 100vh;
                            display: flex; flex-direction: column; justify-content: center; align-items: center;
                            background: #fff;
                        }
                        .container {
                            border: 8px solid #0f172a;
                            padding: 40px;
                            border-radius: 30px;
                            width: 80%;
                            max-width: 600px;
                            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
                        }
                        h1 { font-size: 3.5rem; margin: 0; color: #1e293b; line-height: 1.1; margin-bottom: 10px; }
                        h2 { font-size: 1.8rem; color: #64748b; margin: 0; font-weight: 500; text-transform: uppercase; letter-spacing: 2px; }
                        .qr-box { margin: 40px auto; }
                        .qr-img { width: 350px; height: 350px; border: 2px solid #eee; padding: 10px; border-radius: 10px; }
                        .cta { font-size: 2rem; font-weight: bold; color: #2563eb; background: #eff6ff; padding: 15px; border-radius: 10px; display: inline-block; }
                        .footer { margin-top: 40px; font-size: 0.9rem; color: #94a3b8; }
                        @media print {
                            body { -webkit-print-color-adjust: exact; }
                            .container { border: 5px solid #000; width: 90%; }
                        }
                    </style>
                </head>
                <body>
                    <div class="container">
                        ${logoHtml}
                        <h1>${name}</h1>
                        <h2>${title}</h2>
                        
                        <div class="qr-box">
                            <img src="${qrImgData}" class="qr-img">
                        </div>
                        
                        <div class="cta">Hƒ±zlƒ± ƒ∞≈ülem ƒ∞√ßin Okutun üì∑</div>
                        
                        <div class="footer">
                            Dijital Asistan Sistemi | Developed by Batuhan Bayatlƒ±
                        </div>
                    </div>
                    <script>
                        // Resimlerin y√ºklenmesini bekle sonra yazdƒ±r
                        setTimeout(() => { window.print(); }, 500);
                    <\/script>
                </body>
                </html>
            `);
            printWindow.document.close();
        }

        function copyLink() {
            const link = document.getElementById('finalLinkInput');
            link.select();
            document.execCommand("copy");
            alert("Link Kopyalandƒ±!");
        }

        window.onload = function() {
            checkLegal();
            const p = new URLSearchParams(window.location.search);
            if (p.has('name')) {
                document.body.classList.add('view-mode');
                
                document.getElementById('inpName').value = p.get('name');
                document.getElementById('inpTitle').value = p.get('title');
                document.getElementById('inpPhone').value = p.get('phone');
                document.getElementById('inpWs').value = p.get('ws');
                document.getElementById('inpAddress').value = p.get('addr');
                document.getElementById('inpWeb').value = p.get('web');
                document.getElementById('inpIban').value = p.get('iban');
                document.getElementById('inpLogo').value = p.get('logo');
                document.getElementById('inpBgImg').value = p.get('bg');
                
                if(p.get('c1')) document.getElementById('colBg1').value = '#' + p.get('c1');
                if(p.get('c2')) document.getElementById('colBg2').value = '#' + p.get('c2');
                if(p.get('cb')) document.getElementById('colBtn').value = '#' + p.get('cb');
                if(p.get('cw')) document.getElementById('colWeb').value = '#' + p.get('cw');
                if(p.get('ct')) document.getElementById('colText').value = '#' + p.get('ct');
                
                document.getElementById('nameBold').value = p.get('sb') === '1' ? 'true' : 'false';
                document.getElementById('nameItalic').value = p.get('si') === '1' ? 'true' : 'false';

                updatePreview();
            }
        };
        
        function copyToClipboard() {
            const text = document.getElementById('rawIban').value;
            if(text) { navigator.clipboard.writeText(text); document.getElementById('toast').style.opacity = '1'; setTimeout(() => document.getElementById('toast').style.opacity = '0', 2000); }
        }
    </script>
</body>
</html>